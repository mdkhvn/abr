---
- hosts: all
  become: true
  become_user: khvn
  roles:
    - {role: os-update, tags: "update"}
    - {role: hosts, tags: "hosts"}
- hosts: mysql
  become: true
  # become_user: khvn
  roles:
    - {role: mysql, tags: "mysql"}
    - {role: rsyslog, tags: "rsyslog"}
    - {role: apparmor, tags: "apparmor"}

- hosts: kafka
  become: true
  # become_user: khvn
  roles:
    - {role: kafka, tags: "install_kafka"}

- hosts: postgres
  become: true
  # become_user: khvn
  roles:
    - {role: postgres, tags: "postgres"}

- hosts: consumer_app
  become: true
  roles:
    - {role: "consumer_app", tags: "consumer"}